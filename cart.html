<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout | Zexario</title>

<link rel="icon" href="logo.jpeg">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root {
  --mustard: #D4A017;
  --black: #111;
  --white: #fff;
  --gray: #f6f6f6;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  background: var(--white);
  color: var(--black);
  padding-top: 60px;
  padding-bottom: 60px;
}

/* ================= TOP NAVBAR ================= */
.top-navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 50px;
  background: var(--white);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 13px;
  border-bottom: 1.4px solid var(--mustard);
  z-index: 1000;
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 6px;
}

.logo-container img {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 1.4px solid var(--mustard);
}

.brand-name {
  font-size: 15px;
  font-weight: bold;
}

.right-nav {
  display: flex;
  align-items: center;
  gap: 10px;
}

.cart-count {
  color: var(--mustard);
  font-weight: bold;
}

.menu-toggle {
  width: 32px;
  height: 32px;
  background: var(--mustard);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.menu-toggle i {
  color: var(--black);
}

.navbar {
  position: absolute;
  top: 60px;
  right: 20px;
  background: var(--white);
  border: 1px solid var(--mustard);
  display: none;
  flex-direction: column;
  width: 180px;
  border-radius: 8px;
  overflow: hidden;
}

.navbar.active {
  display: flex;
}

.navbar a {
  padding: 11px 12px;
  text-decoration: none;
  color: var(--black);
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 15px;
  border-bottom: 1px solid #eee;
}

.navbar a i {
  color: var(--mustard);
}

.navbar a:hover {
  background: var(--mustard);
  color: var(--white);
}

.navbar a:hover i {
  color: var(--white);
}

/* ================= MAIN ================= */
.container {
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

h2 {
  text-align: center;
  margin-bottom: 25px;
  font-size: 26px;
  letter-spacing: 1px;
}

/* ================= CART ITEMS ================= */
.cart-item {
  display: flex;
  gap: 15px;
  background: var(--gray);
  border: 1px solid #ddd;
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 15px;
}

.cart-item img {
  width: 90px;
  border-radius: 10px;
  border: 1px solid var(--mustard);
}

.item-details {
  flex: 1;
  font-size: 14px;
}

.remove-btn {
  background: transparent;
  border: 1.5px solid var(--black);
  color: var(--black);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  cursor: pointer;
}

.remove-btn:hover {
  background: var(--black);
  color: var(--white);
}

/* ================= CHECKOUT CARD ================= */
.checkout-card {
  margin-top: 40px;
  border: 2px solid var(--mustard);
  border-radius: 20px;
  padding: 30px 25px;
  background: var(--white);
}

.step-title {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 15px;
  border-left: 4px solid var(--mustard);
  padding-left: 10px;
}

.checkout-card input,
.checkout-card select,
.checkout-card button {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border-radius: 25px;
  font-size: 14px;
}

.checkout-card input,
.checkout-card select {
  border: 1.5px solid #ccc;
}

.checkout-card button {
  margin-top: 20px;
  background: var(--mustard);
  color: var(--black);
  border: none;
  font-size: 15px;
  font-weight: bold;
  cursor: pointer;
}

.checkout-card button:hover {
  background: var(--black);
  color: var(--white);
}

/* ================= PAYMENT INFO ================= */
#easyInstructions,
#codMessage {
  margin-top: 12px;
  padding: 14px;
  border-radius: 12px;
  font-size: 14px;
}

#easyInstructions {
  background: #fff6dd;
  border-left: 4px solid var(--mustard);
}

#codMessage {
  background: #f1f1f1;
  border-left: 4px solid var(--black);
}
</style>
</head>

<body>

<!-- NAVBAR -->
<nav class="top-navbar">
  <div class="logo-container">
    <img src="logo.jpeg" alt="notfound">
    <span class="brand-name">Zexario</span>
  </div>

 <div class="right-nav">
    <div class="cart-container" onclick="openCart()">
      <i class="fas fa-shopping-cart"></i>
      <span class="cart-count">(0)</span>
    </div>

    <div class="menu-toggle" id="menuToggle">
      <i class="fa-solid fa-bars"></i>
    </div>

    <nav class="navbar" id="navMenu">
      <a href="home.html"><i class="fa-solid fa-house"></i> Home</a>
      <a href="about.html"><i class="fa-solid fa-circle-info"></i> About</a>
      <a href="contact.html"><i class="fa-solid fa-envelope"></i> Contact</a>
      <a href="review.html"><i class="fa-solid fa-star"></i> Reviews</a>
      <a href="tees.html"><i class="fa-solid fa-shirt"></i> T-Shirts</a>
      <a href="hoodies.html"><i class="fa-solid fa-layer-group"></i> Hoodies</a>
      <a href="downshoulders.html"><i class="fa-solid fa-user"></i> Down Shoulders</a>
    </nav>
  </div>
</nav>

<div class="container">
  <h2>Checkout</h2>

  <div id="cartItems"></div>

  <!-- CHECKOUT FORM -->
  <form id="checkoutForm" class="checkout-card" enctype="multipart/form-data">

    <div class="step-title">Customer Information</div>

    <input type="text" name="name" placeholder="Full Name" required>
    <input type="email" name="email" placeholder="Email Address" required>
    <input type="tel" name="phone" placeholder="Contact Number" required>
    <input type="text" name="address" placeholder="Shipping Address" required>
    <input type="text" name="city" placeholder="City" required>

    <div class="step-title" style="margin-top:25px;">Payment Method</div>

    <select name="paymentMethod" id="paymentMethod" required>
      <option value="">Select Payment Method</option>
      <option value="CashOnDelivery">Cash on Delivery</option>
      <option value="EasyPaisa">EasyPaisa</option>
    </select>

    <div id="codMessage" style="display:none;">
      Delivery charges confirmation required. Our team will contact you.
    </div>

    <div id="easyInstructions" style="display:none;">
      <strong>EasyPaisa Payment</strong><br>
      Send to: <b>0319-5274167</b><br>
      Name: <b>M Hamza</b>
      <h3>Team will contact you for the screenshot of payment shortly.Thankyou.</h3>
    </div>

    <button type="submit">Confirm Order</button>
  </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* NAV MENU */
  const menuToggle = document.getElementById("menuToggle");
  const navMenu = document.getElementById("navMenu");

  if (menuToggle && navMenu) {
    menuToggle.onclick = () => navMenu.classList.toggle("active");
  }

  /* CART */
  const cartItemsDiv = document.getElementById("cartItems");
  const cartCount = document.getElementById("cartCount");
  const checkoutForm = document.getElementById("checkoutForm");
  const paymentMethod = document.getElementById("paymentMethod");
  const easyInstructions = document.getElementById("easyInstructions");
  const codMessage = document.getElementById("codMessage");

  // Use localStorage for cart
  let cart = JSON.parse(localStorage.getItem("cart")) || [];

  function updateCartCount() {
    const total = cart.reduce((sum, item) => sum + Number(item.quantity), 0);
    if (cartCount) cartCount.textContent = `(${total})`;
  }

  function displayCart() {
    if (!cartItemsDiv) return;

    if (!cart.length) {
      cartItemsDiv.innerHTML = "<p>Your cart is empty.</p>";
      return;
    }

    cartItemsDiv.innerHTML = "";

    cart.forEach((item, index) => {
      cartItemsDiv.innerHTML += `
        <div class="cart-item">
          <img src="${item.image}" alt="">
          <div class="item-details">
            <strong>${item.product}</strong><br>
            Size: ${item.size} | Qty: ${item.quantity}<br>
            Rs. ${item.price}
          </div>
          <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
        </div>
      `;
    });
  }

  window.removeItem = function(index) {
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    displayCart();
    updateCartCount();
  };

  /* PAYMENT METHOD TOGGLE */
  if (paymentMethod) {
    paymentMethod.onchange = () => {
      easyInstructions.style.display =
        paymentMethod.value === "EasyPaisa" ? "block" : "none";

      codMessage.style.display =
        paymentMethod.value === "CashOnDelivery" ? "block" : "none";
    };
  }

  /* CHECKOUT SUBMIT */
  if (checkoutForm) {
    checkoutForm.onsubmit = async e => {
      e.preventDefault();

      if (!cart.length) {
        alert("Cart is empty");
        return;
      }

      const data = {
        name: checkoutForm.name.value,
        email: checkoutForm.email.value,
        phone: checkoutForm.phone.value,
        address: checkoutForm.address.value,
        city: checkoutForm.city.value,
        paymentMethod: checkoutForm.paymentMethod.value,
        cart
      };

      try {
        const res = await fetch("https://zexario-backend.onrender.com/checkout", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        if (res.ok) {
          localStorage.removeItem("cart");
          window.location.href = "thankyou.html";
        } else {
          const errMsg = await res.text();
          alert("Order failed: " + errMsg);
        }
      } catch (err) {
        console.error(err);
        alert("Server error");
      }
    };
  }

  displayCart();
  updateCartCount();

});
</script>

</body>
</html>

